# แบบฟอร์มขออนุมัติเดินทางไปราชการ

เว็บไซต์สำหรับสร้างแบบฟอร์มขออนุมัติเดินทางไปราชการและแบบฟอร์มบันทึกรายงานการเดินทางไปราชการ

## การแก้ไขปัญหาการรีเฟรชหน้าเว็บ

### ปัญหาที่พบ
เว็บไซต์มีการรีเฟรชหน้าเว็บโดยไม่ตั้งใจเมื่อคลิกปุ่มหรือลิงก์ต่างๆ

### การแก้ไข

#### 1. แก้ไขฟังก์ชัน switchForm และ switchForm2
- เพิ่ม `event.preventDefault()` เพื่อป้องกันการรีเฟรชจาก anchor links
- ส่ง event object จาก HTML ไปยังฟังก์ชัน

#### 2. เพิ่ม return false ในฟังก์ชันเพิ่มแถว
- `addEntry1()` - เพิ่มแถวผู้ร่วมเดินทาง
- `addAccommodationLine()` - เพิ่มแถวค่าที่พัก
- `addRegistrationfeeLine()` - เพิ่มแถวค่าลงทะเบียน
- `addothercostLine()` - เพิ่มแถวค่าใช้จ่ายอื่นๆ
- `addrow()` - เพิ่มแถวในหน้าแบบฟอร์มรายงาน
- `addRealAccommodationRow()` - เพิ่มแถวค่าที่พักจริง
- `R_addOtherLine()` - เพิ่มแถวค่าใช้จ่ายอื่นๆจริง
- `addDateSection()` - เพิ่มส่วนวันที่ใหม่

#### 3. เพิ่ม event listeners เพื่อป้องกันการรีเฟรช
- ป้องกันการรีเฟรชจากปุ่มที่มี onclick
- ป้องกันการรีเฟรชจากลิงก์ที่มี onclick
- ป้องกันการรีเฟรชจาก form submission
- ป้องกันการรีเฟรชจาก keyboard shortcuts (Ctrl+R, F5)
- ป้องกันการรีเฟรชจาก browser events

#### 4. เพิ่ม CSS เพื่อป้องกันการรีเฟรช
- ป้องกันการรีเฟรชจาก CSS animations
- ป้องกันการรีเฟรชจาก transitions
- ป้องกันการรีเฟรชจาก hover effects

### ผลลัพธ์
- เว็บไซต์ไม่มีการรีเฟรชหน้าเว็บโดยไม่ตั้งใจ
- ฟังก์ชันการทำงานต่างๆ ยังคงทำงานได้ปกติ
- ประสบการณ์การใช้งานดีขึ้น

## ฟีเจอร์

- สร้างแบบฟอร์มขออนุมัติเดินทางไปราชการ
- สร้างแบบฟอร์มบันทึกรายงานการเดินทางไปราชการ
- คำนวณค่าใช้จ่ายอัตโนมัติ
- ส่งออกเป็นไฟล์ PDF และ DOCX
- รองรับการเพิ่ม/ลบแถวข้อมูล
- ใช้ฟอนต์ภาษาไทย

## การใช้งาน

1. เปิดไฟล์ `index.html` ในเบราว์เซอร์
2. เลือกประเภทแบบฟอร์มที่ต้องการ
3. กรอกข้อมูลในฟอร์ม
4. คลิกปุ่มดาวโหลดเพื่อส่งออกเป็นไฟล์ PDF หรือ DOCX

## ไฟล์ที่เกี่ยวข้อง

- `index.html` - ไฟล์หลักของเว็บไซต์
- `script.js` - JavaScript สำหรับฟังก์ชันหลัก
- `switrch_form.js` - JavaScript สำหรับสลับฟอร์ม
- `cal_p2.js` - JavaScript สำหรับการคำนวณ
- `style.css` - CSS สำหรับการจัดรูปแบบ
- `allowanceStyle.css` - CSS สำหรับส่วนค่าเบี้ยเลี้ยง
- `jspdf.js` - JavaScript สำหรับสร้างไฟล์ PDF
- `docx_generator.js` - JavaScript สำหรับสร้างไฟล์ DOCX
